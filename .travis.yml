language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: HbR+vVMUBUY392V8YPPICpy/BHGpJHiTeGH34TDWMK+T1XX4pBpqvYnHquhk95GhTtNMC9ck8fRf3HPGeM37hCpHPpic0jmYEKXSb8muul4VopedwMWVP1q12W5TDdXX3Mu7NfufJFKgUUHiKsj8ZlhHPF9ntsQVaKMGEn56+Jn59RrAKnIRDm5cM2/k36FAEnIRLmfEbLAqAa0z8dVPjoKmNRIiBCk6XAcAbo3rLN/VqCoATaW+ZLOXsYkLtOdeTMpccXHVVgsuwGgjC4y8Qaij3cucK/JC+WP8Us8tzQ/AmbgEEoGPQnwcBWdzFdyuMn9C+6W7RpG3fBmL2x+qtZmLvyUGXu0bjPiiUcz4CMmT2onMen1YzJFxPXoWGekd6JHWFyMIbiz6aTPDWZdRdbDIdXm+Xyvq9xe3L50iEq2JF59HJiaH387qnFKgBmwqkHThqMpyjB0Sau9eDtW9FlhMaGVCnaS9Fvrls04Dhsrp7WdEIlo1Vgw4Gsaidez4qZGjnzc7LJ4f1pG6JONiDv51rKnVYicc40l0O8lXwmzc793w9mRj988KOwuU+fAvmIgpnx3/a0Xqcs9kg4hcgTXdZj0XRlYJF8oXCkfFMVgVYl96xFTe6IRF4sSCLNE3rkfR5DC/VHT1+yY3Ugt4xFAD0x/0IHMa5udhyLFZAxA=
    on_start: always
    on_success: always
